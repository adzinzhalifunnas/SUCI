{% extends "main/layouts/base.html" %}

{% block title %}
<title>Live Total Donation</title>
{% endblock %}

{% block style %}
<style>
    .keren {
        height: 200px;
        width: 700px;
        font-size: 45px;
        font-family: Arial, Helvetica, sans-serif;
        background-color: rgb(128,0,0);
        display: table-cell;
        vertical-align: middle;
    }
</style>
{% endblock %}

{% block content %}
<div class="px-1 py-1 rounded keren text-white">
    <center>
        <span>{{milestone_title}}</span><br>
        <span id="total">Rp. 0</span>
    </center>
</div>
{% endblock %}

{% block script %}
<script>
    function convertToRupiah(angka){
        let rupiah = '';		
        let angkarev = angka.toString().split('').reverse().join('');
        for(let i = 0; i < angkarev.length; i++) if(i%3 == 0) rupiah += angkarev.substr(i,3)+'.';
        return 'Rp. '+rupiah.split('',rupiah.length-1).reverse().join('');
    }

    $(document).ready(() => {
        const total = $('#total');
        $.ajax({
            url: '{% url "api-milestone" %}',
            type: 'GET',
            success: (data) => {
                total.html(convertToRupiah(data))
            },
          });
      
          setInterval(() => {
            $.ajax({
              url: '{% url "api-milestone" %}',
              type: 'GET',
              success: (data) => {
                total.html(convertToRupiah(data))
              },
            });
          }, 60000);
    });
</script>
{% endblock %}